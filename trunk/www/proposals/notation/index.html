<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<TITLE>Proposal for Notation in ArgoUML</TITLE>
<META NAME="Author" CONTENT="Michiel van der Wulp">
  <META NAME="Keywords"
    CONTENT="ArgoUML,UML,notation,generation,parser,parsing">
<META NAME="Description" CONTENT="Notation in ArgoUML">
</HEAD>

<BODY bgcolor="#FFFFFF" text="#000000">
    <table border="0" cellpadding="2" width="100%" bgcolor="#CCCCCC">
      <tr>
        <td width="100%" bgcolor="#CCCC99">
          <strong><font color="000033" face="Arial, Helvetica, sans-serif">
            Proposal for Notation in ArgoUML
          </font></strong>
        </td>
      </tr>
      <tr>
        <td width="100%">

<P>This proposal is related to
  <a href="http://argouml.tigris.org/issues/show_bug.cgi?id=1207"> issue 1207 </a>
  and <ahref="http://argouml.tigris.org/issues/show_bug.cgi?id=1183"> issue
  1183 </a>. Also interesting is the discussion at the dev list, see:
  <a href="http://argouml.tigris.org/servlets/ReadMsg?list=dev&msgNo=16309">
  http://argouml.tigris.org/servlets/ReadMsg?list=dev&msgNo=16309</a>
  and the attachment from Michael.</p>
  <p>The latest .zargo of this proposal is 
  <a href="notation-mvw-7.zargo">here</a>.</P>

<H2>The old way / dev list proposal</H2>

<p>Basically, one possible way to handle notation 
  is to give the uml object and the "context" to a 
  notationmanager, which determines what to do with it 
  from the kind of object delivered, 
  and then returns the resulting string. 
  In this case the Fig has to know 
  which modelelements to listen to for modelchanges, 
  and also the Fig is listening to notation language updates.
  </p>

<H2>The new proposal</H2>

<p>The interface NotationProvider4 is at the center of the new proposal.
  There is an object implementing the NotationProvider4 interface 
  per string (i.e. textual model representation) that is
  shown on the diagram: e.g. TransitionNotation, 
  StateBodyNotation, ModelElementNameNotation. 
  A state will show the latter 2.</p>
<p>This notation object would keep track of which UML objects it 
  represents, generate and parse and provide a help text.</p>
<p>This notation object should listen to model changes, instead of the Fig. 
  Putting the latter task into this new Notation class (instead of the Fig) 
  has the advantage that the knowledge 
  to which uml objects to listen is centralised 
  where it is needed, and not any more in the Fig.</p>

<p><img src="fig1.png"></img></p>

<p>These Notation objects are abstract, 
  since they are specialised in classes 
  that implement them for a certain language, 
  i.e. one per language. 
  So, we will have: TransitionNotationUML, TransitionNotationJava, ... etc.
</p>  

<H3>The NotationProviderFactory2</H3>
<p><img src="fig2.png"></img></p>
<p>The NotationProviderFactory2 is a singleton, 
  since it is the accesspoint for all Figs 
  to access the textual representation of modelobjects, 
  and since plugin modules can add extra languages.</p>
<p>
<p>The NotationContext and ArgoNotationEventListener 
  are identical as in the past. 
  The Figs call the NotationProviderFactory as follows at creationtime:
<pre>
  NotationProviderFactory2 factory = NotationProviderFactory2.getInstance();
  NotationProvider4 notationProvider 
      = factory.getNotationProvider(factory.typeStateBody, this);
</pre>
  and then, instead of: 
<pre>
  String newText = Notation.generateStateBody(this, state);
  internal.setText(newText);
</pre>
  we do the following:
<pre>
  String newText = notationProvider.toString();
  internal.setText(newText);
</pre>
</p>
<p>And for parsing we can replace:<pre>
  String s = ft.getText();
  try {
	    ParserDisplay.SINGLETON.parseStateBody(state, s);
	} catch (ParseException pe) {
      ....
</pre>with
<pre>
  String s = ft.getText();
	notationProvider.parse(s);
</pre></p>
<p>Etcetera...</p>

  
          </td>
      </tr>
    </table>
   <hr align="CENTER">


<p>  <a href="../index.html">Proposals</a>
     |
     <a href="/index.html">ArgoUML Home</a>
     |
     <a href="/dev.html">Developer Zone</a>
</p>

</BODY>
</HTML>
