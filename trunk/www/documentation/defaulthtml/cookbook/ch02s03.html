<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>2.3.&nbsp;Build Process</title><link rel="stylesheet" href="look-and-feel.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.66.1"><link rel="start" href="index.html" title="Cookbook for Developers of ArgoUML"><link rel="up" href="ch02.html" title="Chapter&nbsp;2.&nbsp;Building from source"><link rel="prev" href="ch02s02.html" title="2.2.&nbsp;Download from the CVS repository"><link rel="next" href="ch02s04.html" title="2.4.&nbsp;The JUnit test cases"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">2.3.&nbsp;Build Process</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch02s02.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;2.&nbsp;Building from source</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch02s04.html">Next</a></td></tr></table><hr></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Build"></a>2.3.&nbsp;Build Process</h2></div></div></div><a class="indexterm" name="d0e771"></a><a class="indexterm" name="d0e776"></a><p>
The ArgoUML build process is driven by ANT, and it is highly recommend
that you stick to that.
There are people known to build from JBuilder or Netbeans, but always
make sure that your work compile with the plain vanilla build process.
     </p><p>
Ant is a tool written in Java developed for Apache that reads an XML-file
with rules telling what to compile to what result and what files to include
in what jar-file.
</p><a class="indexterm" name="d0e783"></a><p>
The rule file is named <tt class="filename">build.xml</tt>.
There is one of those in every separate build directory
(<tt class="filename">src_new</tt>,
<tt class="filename">src/<i class="replaceable"><tt>whatever</tt></i></tt>,
<tt class="filename">documentation</tt>, and
<tt class="filename">modules/<i class="replaceable"><tt>whatever</tt></i></tt>).
</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e808"></a>2.3.1.&nbsp;How ANT is run from the ArgoUML development environment</h3></div></div></div><a class="indexterm" name="d0e811"></a><p>
For your convenience the ant tool of the correct version is present in the
CVS repository of ArgoUML in the file
<tt class="filename">argouml/tools/ant-1.4.1/lib/ant.jar</tt>.
</p><p>
Normally ant is started with the command
<span><b class="command">../tools/ant-1.4.1/bin/ant <i class="replaceable"><tt>arg</tt></i></b></span>
and in the modules
<span><b class="command">
../../tools/ant-1.4.1/bin/ant <i class="replaceable"><tt>arg</tt></i>
</b></span>.
On windows the command
<span><b class="command">..\tools\ant-1.4.1\bin\ant <i class="replaceable"><tt>arg</tt></i></b></span>
runs the program <tt class="filename">ant.bat</tt>.
</p><p>
To keep you from having to write this and keeping track if you are
working with a module or not
there are two scripts (one for Unix and one for
Windows) that are called <tt class="filename">build.sh</tt> and
<tt class="filename">build.bat</tt> respectively present in most
of the directories that contain a <tt class="filename">build.xml</tt> file.
These two scripts run the equivalence of the above paths.
</p><p>
By setting JAVA_HOME to different values you can at different times
build with different versions of JDK and java.
</p><p>
To use different versions of ANT,
you are responsible for installing your own version.
Also, you must execute
<span><b class="command">/where/ever/you/placed/your/new/ant <i class="replaceable"><tt>target</tt></i></b></span>
rather than
<span><b class="command">build <i class="replaceable"><tt>target</tt></i></b></span>.
</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e867"></a>2.3.1.1.&nbsp;Compiling for Unix</h4></div></div></div><a class="indexterm" name="d0e870"></a><a class="indexterm" name="d0e875"></a><p>
Here is what you need to do in order to compile and run
your checked out copy of ArgoUML under Unix.
</p><div class="orderedlist"><ol type="1"><li><p><span><b class="command">JAVA_HOME=<i class="replaceable"><tt>/where/you/have/installed/jdk</tt></i></b></span></p><p><span><b class="command">export JAVA_HOME</b></span></p><p>
This is for sh-style shells like sh, ksh, zsh and bash. If you use
csh-style shells like csh and tcsh you will instead have to write
<span><b class="command">setenv JAVA_HOME <i class="replaceable"><tt>/where/you/have/installed/jdk</tt></i></b></span>.
</p></li><li><p>
Change the current directory to the directory you are building
</p><p>
<span><b class="command">cd <i class="replaceable"><tt>/your/checked/out/copy/of/argouml/src_new</tt></i></b></span>
</p></li><li><p>Start ant using <span><b class="command">./build.sh</b></span></p><p>This gives you a list of targets with descriptions</p></li><li><a class="indexterm" name="d0e917"></a><a class="indexterm" name="d0e922"></a><p>
Compile and run ArgoUML using <span><b class="command">./build.sh run</b></span>
</p><p>
You can do this over and over again when you have modified something
or want to compile and run again.
</p></li></ol></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e932"></a>2.3.1.2.&nbsp;Compiling for Windows</h4></div></div></div><a class="indexterm" name="d0e935"></a><a class="indexterm" name="d0e940"></a><div class="orderedlist"><ol type="1"><li><p>
<span><b class="command">set JAVA_HOME=<i class="replaceable"><tt>\where\you\have\installed\jdk</tt></i></b></span>
</p></li><li><p>
Change the current directory to the directory you are building
</p><p>
<span><b class="command">chdir <i class="replaceable"><tt>\your\checked\out\copy\of\argouml\src_new</tt></i></b></span>
</p></li><li><p>Start ant using <span><b class="command">build</b></span></p><p>This gives you a list of targets with descriptions</p></li><li><p>
Compile and run ArgoUML using <span><b class="command">build run</b></span>
</p><p>
You can do this over and over again when you have modified something
or want to compile and run again.
</p></li></ol></div><a class="indexterm" name="d0e979"></a><a class="indexterm" name="d0e984"></a><p>
If you do this from Cygwin you work just like for Unix.
</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e989"></a>2.3.1.3.&nbsp;Customizing and configuring your build</h4></div></div></div><a class="indexterm" name="d0e992"></a><a class="indexterm" name="d0e997"></a><a class="indexterm" name="d0e1000"></a><a class="indexterm" name="d0e1003"></a><a class="indexterm" name="d0e1006"></a><a class="indexterm" name="d0e1011"></a><p>
It is possible to customize your compilation of ArgoUML.
</p><p>
If you issue the command
<span><b class="command">build list-property-files</b></span>
you can see what files are searched for properties.
</p><p>
Don't change the
<tt class="filename">argouml/src_new/default.properties</tt>
file (unless you are working with updating the development environment
itself).
Instead create one of the other files locally on you machine.
The properties in these files have precedence over the properties in
<tt class="filename">argouml/src_new/default.properties</tt>.
</p><p>
Remember that if you do this, you have modified your development
environment.
To be sure that you will not break anything for
anyone else when checking in things 
developed using this modified environment, 
remove these files temporarily for the compiling and testing
you do just before you commit.
	  </p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1031"></a>2.3.1.4.&nbsp;Building javadoc</h4></div></div></div><a class="indexterm" name="d0e1034"></a><a class="indexterm" name="d0e1037"></a><a class="indexterm" name="d0e1042"></a><a class="indexterm" name="d0e1047"></a><p>
By running ANT again using <span><b class="command">build prepare-docs</b></span>
the javadoc documentation is generated and put into
<tt class="filename">argouml/build/javadocs</tt>.
</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1058"></a>2.3.1.5.&nbsp;Building one of the modules</h4></div></div></div><p>
If you want to run ArgoUML with modules enabled the 
<tt class="filename">build.xml</tt>s are set up to do this in two ways:
            </p><div class="orderedlist"><ol type="1"><li><p>Test just one module</p><div class="orderedlist"><ol type="a"><li><p>Build ArgoUML, the package</p><p>
This is done with <span><b class="command">ant package</b></span>
in the <tt class="filename">argouml/src_new</tt>-directory.
</p></li><li><p>Run the module</p><p>
This is done with <span><b class="command">ant run</b></span>-command 
in the 
<tt class="filename">
argouml/modules/<i class="replaceable"><tt>whatever</tt></i>
</tt>-directory.
</p></li></ol></div></li><li><p>Test several modules together</p><div class="orderedlist"><ol type="a"><li><p>Build ArgoUML, the package</p><p>
This is done with <span><b class="command">ant package</b></span>
in the <tt class="filename">argouml/src_new</tt>-directory.
</p></li><li><p>Compile and install the modules</p><p>
This is done with <span><b class="command">ant install</b></span>-command
in each of the 
<tt class="filename">
argouml/modules/<i class="replaceable"><tt>whatever</tt></i>
</tt>-directories.
</p></li><li><p>Start ArgoUML</p><p>
This is done with <span><b class="command">ant run</b></span>
in the <tt class="filename">argouml/src_new</tt>-directory.
</p></li></ol></div><p>
This will start ArgoUML with all modules available.
</p></li></ol></div><p>         
</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="generating_documentation"></a>2.3.2.&nbsp;Generating documentation</h3></div></div></div><p>
This describes how the documentation is generated
i.e. both what to do and how the setup works.
</p><p>
If you are in a hurry:
</p><pre class="programlisting">
C:\Work&gt;set CVSROOT=:pserver:guest@cvs.tigris.org:/cvs
C:\Work&gt;cvs login   (use guest as password)
C:\Work&gt;cvs checkout argouml/documentation argouml/tools argouml/lib
C:\Work&gt;set JAVA_HOME=<i class="replaceable"><tt>C:\Programs\jdkwhatever</tt></i>
C:\Work&gt;cd argouml\documentation
C:\Work\argouml\documentation&gt;build defaulthtml
</pre><p>
The html version of the Cookbook, Quick-Guide, and User Manual are
built and the result end up in.
<tt class="filename">C:\Work\argouml\build\documentation\defaulthtml\cookbook</tt>,
<tt class="filename">C:\Work\argouml\build\documentation\defaulthtml\quick-guide</tt>,
and
<tt class="filename">C:\Work\argouml\build\documentation\defaulthtml\manual</tt>
respectively.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
From here on it is the old text that is more or less "Publishing ArgoUML"
to be reworked.
</p></td></tr></table></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="how_the_web_site_works"></a>2.3.2.1.&nbsp;How the ArgoUML web site works</h4></div></div></div><a class="indexterm" name="d0e1167"></a><p>
Tigris provides the ArgoUML site to be edited through CVS. Everything
that is checked in under <tt class="filename">argouml/www</tt>
becomes immediately available at the URL 
<a href="http://argouml.tigris.org/" target="_top">http://argouml.tigris.org/</a>
with some added decorations.
</p><p>
Example: The file <tt class="filename">argouml/www/project.html</tt> is
available at 
<a href="http://argouml.tigris.org/project.html" target="_top">http://argouml.tigris.org/project.html</a>.
</p><p>
This is the way the site is maintained and updated.
</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1190"></a>2.3.2.2.&nbsp;The ArgoUML documentation</h4></div></div></div><a class="indexterm" name="d0e1193"></a><a class="indexterm" name="d0e1196"></a><p>
For the ArgoUML project the same documentation shall be available in both
HTML, PDF and javahelp. To this end the documentation is written in
docbook XML and generated into two versions of HTML 
(one page per chapter and one page for the whole book),
PDF and javahelp.
</p><p>
We have tools that does the conversion from docbook XML to HTML and PDF.
The conversion is done whenever you need to look at the result or when 
you want to present the final result on the web site.
</p><p>
There are currently three different books generated in this way,
each into its own directory. They are cookbook (this document), 
manual and quick-guide. They are all generated and stored in the
exact same way except for the name of the directory that is one
of <tt class="filename">cookbook</tt>,
<tt class="filename">manual</tt> or 
<tt class="filename">quick-guide</tt>.
Below I will reference these directories using
<tt class="filename"><i class="replaceable"><tt>book</tt></i></tt>.
</p><p>
When a new version of the documentation is to be made available on the
web site the responsible document release person does the following:
</p><div class="orderedlist"><ol type="1"><li><p>
He checks out everything needed
and a copy of the <tt class="filename">argouml/www</tt>.
</p><p>
If wanted, the CVS repository could be tagged and then the tag
can be checked out. This makes it possible to know exactly
how a certain version of the documentation was generated.
</p></li><li><a class="indexterm" name="d0e1232"></a><a class="indexterm" name="d0e1237"></a><p>
The documentation is generated using <span><b class="command">build docs</b></span>.
</p><p>
This generates all three books and the result appears in
<tt class="filename">argouml/build/documentation/defaulthtml/<i class="replaceable"><tt>book</tt></i></tt>,
<tt class="filename">argouml/build/documentation/printablehtml/<i class="replaceable"><tt>book</tt></i></tt>, and
<tt class="filename">argouml/build/documentation/pdf/<i class="replaceable"><tt>book</tt></i></tt>.
</p><p>
This has been done several times before while preparing the release so
no problems are expected. If there are problems then the preparations
were not good enough and the process is best stopped right here.
</p></li><li><p>
All the old files are removed from the checked out copy of 
<tt class="filename">argouml/www/documentation/defaulthtml/<i class="replaceable"><tt>book</tt></i></tt>, 
<tt class="filename">argouml/www/documentation/printablehtml/<i class="replaceable"><tt>book</tt></i></tt>.
</p></li><li><p>
New files are copied into the checked out copy of <tt class="filename">www</tt>
on top of the previous files there replacing them.
</p><p>
All the files are copied from
<tt class="filename">argouml/build/documentation/defaulthtml/<i class="replaceable"><tt>book</tt></i></tt> to
<tt class="filename">argouml/www/documentation/defaulthtml/<i class="replaceable"><tt>book</tt></i></tt>. 
The same for <tt class="filename">printablehtml</tt> and 
<tt class="filename">pdf</tt>.
</p></li><li><p>
No longer used files in 
<tt class="filename">argouml/www/documentation</tt>
are removed from CVS and new files are added.
</p><p><span><b class="command">cvs -n update</b></span></p><p>Watch for "Missing" and "Unknown" files.</p><p>
The missing files are scheduled to be removed by:
<span><b class="command">cvs remove <i class="replaceable"><tt>each of the missing files</tt></i></b></span>
</p><p>
The "Unknown" files are scheduled to be added by:
<span><b class="command">cvs add <i class="replaceable"><tt>each of the added files</tt></i></b></span>
</p><p>
This removing of missing files and adding of unknown files may seem
backward but it is from the perspective of CVS.
The missing files are the ones that were present in the previous
version of the documentation and do not have a replacement,
either because that chapter does not exist anymore or that the tool
generates filenames differently.
The Unknown files are files with filenames that for the same reason
appear from one version of the documentation to the next.
</p></li><li><p>
Commit the changes thus publishing it on the web site.
</p><p>
<span><b class="command">cvs commit -m'New version of the documentation published'</b></span>
</p></li><li><p>
The PDF book is uploaded to the download page.
</p></li></ol></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1339"></a>2.3.2.3.&nbsp;How we work with documentation</h4></div></div></div><a class="indexterm" name="d0e1342"></a><p>
The developers or authors that work with the documentation or with the tools 
to generate the documentation (or anyone else interested in how it works)
can generate the documentation like described above and examine
the result in
<tt class="filename">argouml/build</tt>.
It is only the last part about checking in and uploading the result
under
<tt class="filename">argouml/www/documentation</tt>
that requires write access in the CVS and 
some configuration management since it more or less is
releasing the manual.
</p><p>
In order to do this you need to check out the whole of the
<tt class="filename">argouml/documentation</tt> directory.
You also need the directory
<tt class="filename">argouml/lib</tt> and
<tt class="filename">argouml/tools</tt>
that contain the tools used: ANT, Fop, saxon, ...
</p><p>
The subdirectories of
<tt class="filename">argouml/documentation</tt>,
<tt class="filename">cookbook</tt>,
<tt class="filename">manual</tt>, and
<tt class="filename">quick-guide</tt>
each contain one of the three books.
The subdirectory
<tt class="filename">docbook-setup</tt>
contains two things. 
It contains the configuration files that control how the generation is done.
It contains the XSL rules for all the generation.
The subdirectory
<tt class="filename">images</tt>
contains all the required pictures for all the books.
</p><p>
When, in the <tt class="filename">documentation</tt> you run
<span><b class="command">./build.sh defaulthtml</b></span> or one of the other targets that
builds the documentation,
all books are built.
What happens is (the target internal-dispatcher):
</p><div class="itemizedlist"><ul type="disc"><li><p>
The 
<tt class="filename"><i class="replaceable"><tt>manual</tt></i>/<i class="replaceable"><tt>argomanual.xml</tt></i></tt>
is copied by ant to
<tt class="filename"><i class="replaceable"><tt>manual</tt></i>/<i class="replaceable"><tt>argomanual-generated.xml</tt></i></tt>
while doing substitution of tokens:
(@VERSION@ to become the version as specified in 
<tt class="filename">default.properties</tt>)
</p></li><li><p>
The file 
<tt class="filename"><i class="replaceable"><tt>manual</tt></i>/<i class="replaceable"><tt>argomanual-generated.xml</tt></i></tt>
is processed by the special 
<tt class="filename">docbook-setup/create-imglist.xsl</tt>
xsl script that generates a list of included images.
</p></li><li><p>
All included images are copied.
</p><p>
The purpose of this is to only get the images actually used copied
with the document that uses them and not all images.
</p></li><li><p>
The html is generated by processing the file
<tt class="filename"><i class="replaceable"><tt>manual</tt></i>/<i class="replaceable"><tt>argomanual-generated.xml</tt></i></tt>.
</p></li></ul></div><p>
The file
<tt class="filename"><i class="replaceable"><tt>manual</tt></i>/<i class="replaceable"><tt>argomanual-generated.xml</tt></i></tt>
is a temporary file that only exists while processing the xml.
If editing the xml with a docbook editors 
you open the file
<tt class="filename"><i class="replaceable"><tt>manual</tt></i>/<i class="replaceable"><tt>argomanual.xml</tt></i></tt>
and edit the unsubstituted file.
The differences between the unsubstituted file and the substituted file
are so small that it shouldn't make any difference.
</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1459"></a>2.3.3.&nbsp;Troubleshooting the development build</h3></div></div></div><a class="indexterm" name="d0e1462"></a><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1467"></a>2.3.3.1.&nbsp;Compiling failed. Any suggestions?</h4></div></div></div><p>
It might be that some other developer has made a mistake in checking
in things that contain errors, or forgotten to check in some files
in a change.
Look at the last couple of hours on the
<a href="http://argouml.tigris.org/servlets/BrowseList?listName=dev" target="_top">
developers mailing list</a>!
It is probably on fire.
</p><a class="indexterm" name="d0e1475"></a><a class="indexterm" name="d0e1480"></a><p>
Another reason for problems is an unclean local source tree.
This means that if you have updated different parts of your source
tree at different times it might contain inconsistencies.
If you suspect this, first try to fix it by doing
<span><b class="command">build clean</b></span> and <span><b class="command">cvs update -d</b></span>
before trying to build again.
If that doesn't work remove your checked out copy completely and 
get it all again through CVS.
</p><p>
Another reason might be that you have an 
<tt class="filename">build.properties</tt> or
<tt class="filename">argouml.build.properties</tt>
file that you have been working with earlier
and that is doing something. If in doubt, remove those files.
</p><p>
If nothing helps, ask the 
<a href="mailto:dev@argouml.tigris.org" target="_top">developers mailing list</a>!
</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1504"></a>2.3.3.2.&nbsp;Can't commit my changes?</h4></div></div></div><a class="indexterm" name="d0e1507"></a><p>
You need to have a developer role in the ArgoUML project.
If you don't then you cannot do commit yourself.
Discuss what you have done and how best to test it on the
<a href="mailto:dev@argouml.tigris.org" target="_top">developers mailing list</a>!
Eventually someone will commit it for you.
</p><p>
Furthermore the checkout of your copy needs to be done with your
Tigris id that has the Developer role.
If you for some reason have earlier checked out
a copy as guest and then made modifications, changed the CVSROOT
variable you still cannot commit changes done in the repository since the
checked out copy contains information on who checked out.
For this reason, it is best to apply for an Observer role in 
the project if you are going to work with the source at all.
The Observer role is probably granted within a couple of days
(we welcome everybody!) and then you can check out with your Tigris id.
This means that when you eventually are granted a Developer role you
can continue working with the same checked out copy.
</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch02s02.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch02.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch02s04.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">2.2.&nbsp;Download from the CVS repository&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;2.4.&nbsp;The JUnit test cases</td></tr></table></div></body></html>