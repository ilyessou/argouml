REL_DIR=uci
!INCLUDE ..\NMakefile.config


all: classes archive

classes: gefDir umlDir argoumlDir criticsDir 


archive:: objdir gefDir umlDir argoumlDir criticsDir 
!IF ! EXIST( $(OUT_DIR)\xml\dtd )
	- mkdir $(OUT_DIR)\xml\dtd
!ENDIF
	$(CD) xml\dtd
	for %f in (*.*) do \
	copy %f $(OUT_DIR)\xml\dtd
	$(CD) ..\..
!IF ! EXIST( $(OUT_DIR)\Images )
	- mkdir $(OUT_DIR)\Images
!ENDIF
	$(CD) Images
	for %f in (*.*) do \
	copy %f $(OUT_DIR)\Images
	$(CD) ..
	copy COPYRIGHT $(OUT_DIR)


clean: gefDir umlDir argoumlDir criticsDir 

processDir:
	@echo.
	@echo Processing directory $(DIR): flags '$(MAKEFLAGS)',target '$(TARGET)'
	@echo.
	$(CD) $(DIR)
	@$(MAKE) /$(MAKEFLAGS) $(TARGET)
	$(CD) $(TOP)


GEF_DIRS= util           \
	gef              \
	gef\event        \
	graph            \
	beans\editors    \
	ui               \
	gef\demo	 \
	xml		 \
	xml\pgml

UML_DIRS= uml\Foundation\Core                   \
	uml\Foundation\Data_Types               \
	uml\Foundation\Extension_Mechanisms     \
	uml\Model_Management                    \
	uml\Behavioral_Elements\Common_Behavior \
	uml\Behavioral_Elements\State_Machines  \
	uml\Behavioral_Elements\Use_Cases       \
	uml\Behavioral_Elements\Collaborations  \
	uml\util                                \
	uml\test\omg                            \
	uml\generate

ARGOUML_DIRS= argo\kernel        \
	argo\checklist           \
	uml\ui                   \
	uml\ui\nav               \
	uml\ui\todo              \
	uml\ui\props             \
	uml\ui\table             \
	uml\ui\style             \
	uml\visual               \
	uml\ocl                  \
	xml\xmi                  \
	xml\argo                 \
	uml                      


CRITICS_DIRS= uml\checklist       \
	uml\critics               \
	uml\critics\patterns      \
	uml\critics\java          \
	uml\critics\presentation  


gefDir:
!IF EXIST(gef)
	@echo. 
	@echo.
	@echo PROCESSING GEF ====================
	@for %d in ($(GEF_DIRS)) do \
	@$(MAKE) /$(MAKEFLAGS) TARGET=$(TARGET) DIR=%d processDir

!ELSE
	@echo.
	@echo.
	@echo GEF directory does not exists.
!ENDIF

umlDir:
!IF EXIST(uml)
	@echo. 
	@echo.
	@echo PROCESSING UML ===================
	@for %d in ($(UML_DIRS)) do \
	@$(MAKE) /$(MAKEFLAGS) TARGET=$(TARGET) DIR=%d processDir
!ELSE
	@echo.
	@echo.
	@echo UML directory does not exists.
!ENDIF

argoumlDir:
!IF EXIST(argo)
	@echo. 
	@echo.
	@echo PROCESSING ARGO/UML ===============
	@for %d in ($(ARGOUML_DIRS)) do \
	@$(MAKE) /$(MAKEFLAGS) TARGET=$(TARGET) DIR=%d processDir
!ELSE
	@echo.
	@echo.
	@echo ARGO directory does not exists.
!ENDIF

criticsDir:
!IF EXIST(uml\critics)
	@echo. 
	@echo.
	@echo PROCESSING CRITICS ================
	@for %d in ($(CRITICS_DIRS)) do \
	@$(MAKE) /$(MAKEFLAGS) TARGET=$(TARGET) DIR=%d processDir
!ELSE
	@echo.
	@echo.
	@echo UML\CRITICS directory does not exists.
!ENDIF














