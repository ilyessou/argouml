<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>2.4.&nbsp;The JUnit test cases</title><link rel="stylesheet" href="look-and-feel.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.66.1"><link rel="start" href="index.html" title="Cookbook for Developers of ArgoUML"><link rel="up" href="ch02.html" title="Chapter&nbsp;2.&nbsp;Building from source"><link rel="prev" href="ch02s03.html" title="2.3.&nbsp;Build Process"><link rel="next" href="ch02s05.html" title="2.5.&nbsp;Manual Test Cases"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">2.4.&nbsp;The JUnit test cases</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch02s03.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;2.&nbsp;Building from source</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch02s05.html">Next</a></td></tr></table><hr></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="junittests"></a>2.4.&nbsp;The JUnit test cases</h2></div></div></div><a class="indexterm" name="d0e1424"></a><a class="indexterm" name="d0e1427"></a><a class="indexterm" name="d0e1430"></a><p>
ArgoUML has a set of automatic test cases using JUnit-framework
for testing the insides of the code.
The purpose of these are to help in pin-pointing problems with
code changes before even starting ArgoUML.
</p><p>
The JUnit test cases are residing in a separate directory and
run from ant targets in the
<tt class="filename">src_new/build.xml</tt>.
They are never distributed with ArgoUML but merely a tool for
developers.
</p><a class="indexterm" name="d0e1440"></a><a class="indexterm" name="d0e1445"></a><a class="indexterm" name="d0e1448"></a><a class="indexterm" name="d0e1453"></a><p>
By running the command
<span><b class="command">build tests guitests</b></span>
in <tt class="filename">src_new</tt>
these test cases are started, each in their own jvm.
</p><p>
Each test case writes its result on the Ant log.
</p><p>
The result is also generated into a set of files that can be found at
<tt class="filename">build/test/reports/junit/output/html/index.html</tt>.
</p><p>
The test cases' java source code is located under
<tt class="filename">argouml/tests/org/argouml</tt>.
</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1476"></a>2.4.1.&nbsp;How to write a test case</h3></div></div></div><a class="indexterm" name="d0e1479"></a><a class="indexterm" name="d0e1482"></a><a class="indexterm" name="d0e1485"></a><a class="indexterm" name="d0e1490"></a><p>
Now this will make all you java-enthusiasts go nuts!
We have both class names and method names with a special syntax.
</p><a class="indexterm" name="d0e1495"></a><a class="indexterm" name="d0e1500"></a><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1503"></a>2.4.1.1.&nbsp;About the Test case Class</h4></div></div></div><p>
The name of the test case class starts with "Test" (i.e. Capital T, then
small e, s and t) or 
"GUITest" (i.e. Capital G, U, I, T then small e, s, t).
The reason for this is that the special targets in
<tt class="filename">src_new/build.xml</tt>
search for test case classes with these names.
If you write a test case class that does not comply to this rule, you still
can run the test cases in this class manually 
by starting with
<span><b class="command">build run-with-test-panel</b></span>,
but it wont be known and run by other developers and automatic build
mechanisms so don't do it.
</p><p>
Test case classes that don't require GUI components in place
have filenames like
<tt class="filename">Test<i class="replaceable"><tt>*</tt></i>.java</tt>.
They must be able to run on a headless system.
To make sure that this works, always run your newly developed
test cases with <span><b class="command">build tests</b></span> using 
jdk1.4 or later.
</p><p>
Test case classes that do require GUI components in place
have filenames like
<tt class="filename">GUITest<i class="replaceable"><tt>*</tt></i>.java</tt>.
</p><p>
We should try to get as many tests from a GUITest* class to 
the corresponding Test* class because the latter are run by automatic 
builds regularly.
</p><p>
Every class
<tt class="classname">org.argouml.<i class="replaceable"><tt>x.y</tt></i>.<i class="replaceable"><tt>z</tt></i></tt>
stored in the file
<tt class="filename">src_new/org/argouml/<i class="replaceable"><tt>x/y</tt></i>/<i class="replaceable"><tt>z</tt></i>.java</tt>
should have a JUnit test case class called
<tt class="classname">org.argouml.<i class="replaceable"><tt>x.y</tt></i>.Test<i class="replaceable"><tt>z</tt></i></tt>
stored in the file
<tt class="filename">tests/org/argouml/<i class="replaceable"><tt>x/y</tt></i>/Test<i class="replaceable"><tt>z</tt></i>.java</tt>
containing all the Unit Test Cases for that class
that don't need the GUI components to run.
Tests that 
do need GUI components to run should be part of a class named
<tt class="classname">org.argouml.<i class="replaceable"><tt>x.y</tt></i>.GUITest<i class="replaceable"><tt>z</tt></i></tt>
stored in the file
<tt class="filename">tests/org/argouml/<i class="replaceable"><tt>x/y</tt></i>/GUITest<i class="replaceable"><tt>z</tt></i>.java</tt>
</p><p>
If you only want to run your newly written test cases and not
all the test cases, you could start with the command
<span><b class="command">build run-with-test-panel</b></span>
and give the class name of your test case like
<tt class="classname">org.argouml.<i class="replaceable"><tt>x.y</tt></i>.Test<i class="replaceable"><tt>z</tt></i></tt>
or
<tt class="classname">org.argouml.<i class="replaceable"><tt>x.y</tt></i>.GUITest<i class="replaceable"><tt>z</tt></i></tt>.
You will then get the output in the window.
You could run all tests in this way by specifying the special test suite
<tt class="classname">org.argouml.util.DoAllTests</tt>
in the same way.
</p><p>
Every test case class imports the JUnit framework: 
</p><div class="blockquote"><blockquote class="blockquote"><p>
import junit.framework.*;
</p></blockquote></div><p>
and it inherits <tt class="classname">TestCase</tt>
(i.e. <tt class="classname">junit.framework.TestCase</tt>).
</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1624"></a>2.4.1.2.&nbsp;About the Test case Method</h4></div></div></div><p>
Methods that are tests must have names that start with "test"
(i.e. all small t, e, s, t). This is a requirement of the JUnit
framework.
</p><p>
Try to keep the test cases as short as possible.
There is no need in cluttering them up just to beautify the output.
Prefer
</p><pre class="programlisting">
// Example from JUnit FAQ
public void testIndexOutOfBoundsExceptionNotRaised()
        throws IndexOutOfBoundsException {
    ArrayList emptyList = new ArrayList();
    Object o = emptyList.get(0);
}
</pre><p>
over
</p><pre class="programlisting">
public void testIndexOutOfBoundsExceptionNotRaised() {
    try {
        ArrayList emptyList = new ArrayList();
        Object o = emptyList.get(0);
    } catch (IndexOutOfBoundsException iobe) {
        fail("Index out of bounds exception was thrown.");
    }
}
</pre><p>
because the code is shorter, easier to maintain and you get a better
error message from the JUnit framework.
</p><p>
A lot of times it is useful just to run the compiler to verify that
the signatures are correct on the interfaces. Therefor Linus has
thought it is a good idea to add methods called
<tt class="methodname">compileTestStatics</tt>,
<tt class="methodname">compileTestConstructors</tt>, and
<tt class="methodname">compileTestMethods</tt>
that was thought to include correct calls to all static methods,
all public constructors, and all other public methods that are not
otherwise tested.
These methods are never called.
They serve as a guarantee that the public interface of a class will
never lose any of the functionality provided by its signature in an
uncontrolled way in just the same way as the test-methods serve as a
guarantee that no features will ever be lost.
</p><div class="example"><a name="d0e1648"></a><p class="title"><b>Example&nbsp;2.1.&nbsp;An example without javadoc comments</b></p><a class="indexterm" name="d0e1651"></a><p>
</p><pre class="programlisting">
package org.argouml.uml.ui;
import junit.framework.*;

public class GUITestUMLAction extends TestCase {
    public GUITestUMLAction(String name) {
	super(name);
    }

    // Testing all three constructors.
    public void testCreate1() {
	UMLAction to = new UMLAction(new String("hejsan"));
	assert("Disabled", to.shouldBeEnabled());
    }
    public void testCreate2() {
	UMLAction to = new UMLAction(new String("hejsan"), true);
	assert("Disabled", to.shouldBeEnabled());
    }
    public void testCreate3() {
	UMLAction to = new UMLAction(new String("hejsan"), true, UMLAction.NO_ICON);
	assert("Disabled", to.shouldBeEnabled());
    }
}
</pre><p>
and the corresponding no-GUI-class:
</p><pre class="programlisting">
package org.argouml.uml.ui;
import junit.framework.*;

public class TestUMLAction extends TestCase {
    public TestUMLAction(String name) {
	super(name);
    }

    // Functions never actually called. Provided in order to make
    // sure that the static interface has not changed.
    private void compileTestStatics() {
	boolean t1 = UMLAction.HAS_ICON;
	boolean t2 = UMLAction.NO_ICON;
	UMLAction.getShortcut(new String());
	UMLAction.getMnemonic(new String());
    }

    private void compileTestConstructors() {
	new UMLAction(new String());
	new UMLAction(new String(), true);
	new UMLAction(new String(), true, true);
    }

    private void compileTestMethods() {
	UMLAction to = new UMLAction(new String());
	to.markNeedsSave();
	to.updateEnabled(new Object());
	to.updateEnabled();
	to.shouldBeEnabled();
    }
}
</pre><p>
</p><p></p></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch02s03.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch02.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch02s05.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">2.3.&nbsp;Build Process&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;2.5.&nbsp;Manual Test Cases</td></tr></table></div></body></html>