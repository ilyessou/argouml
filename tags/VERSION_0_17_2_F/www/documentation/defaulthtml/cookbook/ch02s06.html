<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>2.6.&nbsp;Making a release</title><link rel="stylesheet" href="look-and-feel.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.60.1"><link rel="home" href="index.html" title="Cookbook for Developers of ArgoUML"><link rel="up" href="ch02.html" title="Chapter&nbsp;2.&nbsp;Building from source"><link rel="previous" href="ch02s05.html" title="2.5.&nbsp;Manual Test Cases"><link rel="next" href="ch03.html" title="Chapter&nbsp;3.&nbsp;ArgoUML requirements"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">2.6.&nbsp;Making a release</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch02s05.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;2.&nbsp;Building from source</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch03.html">Next</a></td></tr></table><hr></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="release_process"></a>2.6.&nbsp;Making a release</h2></div></div><div></div></div><a class="indexterm" name="d0e1542"></a><p>
The purpose of this chapter is
to simplify for the person that is actually doing the release work and
to make sure that everything is done in the exact same way 
every time and nothing is forgotten.
</p><p>
It is provided with the hopes of being helpful.

</p><p>
To understand this you need knowledge of how CVS works and 
how you normally build and test ArgoUML.
</p><p>
This instruction is supposed to work on a windows system (running build.bat).
The author (Linus Tolke) has for some time been running it 
on a Cygwin system (running build.sh) 
assuming that this will be the same as on any UNIX system.
How it is actually run on a Cygwin/UNIX system is also noted.
</p><p>
Here are the steps to be done when one actually does a release:
</p><p>
	</p><div class="orderedlist"><ol type="1"><li><p>Tag the whole CVS repository with the freeze tag!</p><p>
Normally this tag is "VERSION_<i class="replaceable"><tt>X_Y_Z</tt></i>_F",
e.g. VERSION_0_9_7_F.
The according command line CVS command is 
<b class="command">cvs rtag VERSION_<i class="replaceable"><tt>X_Y_Z</tt></i>_F argouml</b>.
(Because of a problem on the Tigris site, this doesn't work. 
Instead make sure you have a complete checked out copy of ArgoUML,
go to the root directory 
<tt class="filename">argouml</tt>
and run the command
<b class="command">cvs tag VERSION_<i class="replaceable"><tt>X_Y_Z</tt></i>_F</b>.)
</p></li><li><p>
Check out the source!
</p><p>
To be sure we always work from a clean copy and check out from the tag.
</p><p>
This is done using the command
<b class="command">cvs co -r VERSION_<i class="replaceable"><tt>X_Y_Z</tt></i>_F argouml/src_new argouml/src argouml/lib argouml/tools argouml/modules argouml/tests</b>
in a newly created directory.
</p><p>
These commands assume that you have set the CVSROOT correctly. 
If not you will have to use commands like
<b class="command">cvs -d :pserver:<i class="replaceable"><tt>user</tt></i>@cvs.tigris.org:/cvs co ...</b>
instead.
</p></li><li><p>
Check the key to sign the jar files for java web start!
</p><p>
This is to make sure that you have a valid key
for the purpose of signing the java web start version of the files.
</p><p>
Since the ArgoUML project and the Tigris organization are loose
organizations we cannot buy a "real" key.
The keys we use are the unsigned keys
that can be generated by anyone using the keytool provided with java.
</p><p>
A key is generated with the command
<b class="command">keytool -genkey -alias argouml -storepass secret</b>.
</p><p>
By default these keys have a validity of just three (3) months
but by giving the
<i class="parameter"><tt>-validity <i class="replaceable"><tt>days</tt></i></tt></i>
the validity can be extended.
</p></li><li><p>
Build the release!
</p><a class="indexterm" name="d0e1626"></a><a class="indexterm" name="d0e1631"></a><p>
This is done in the
<tt class="filename">argouml/src_new</tt>
directory of the newly created copy
by issuing the command <b class="command">build dist-release</b>!
(Linus:
It takes around 2 minutes on my machine 
        JDK1.3.1_10/Intel 1400MHz (on batteries)/512MB (February 2004),
It takes around 10 minutes on my machine 
	JDK1.3.1_01/Intel 700MHz/256MB (May 2003),
It takes around 30 minutes on a Lysator machine simultaneously 
doing a lot of other things.
	JDK1.3.1_06/Sun4d/256MB (July 2003).
)
</p><p>
On a Cygwin/Unix system you need to 
first make the <b class="command">ant</b> executable with the command
<b class="command">chmod +x ../tools/ant-1.4.1/bin/ant</b>
and then issue the command with 
<b class="command">./build.sh</b> instead of 
<b class="command">build</b>.
</p><p>
This should create the directory
<tt class="filename">argouml/argouml-<i class="replaceable"><tt>VERSION</tt></i></tt>
with the files
<tt class="filename">ArgoUML-<i class="replaceable"><tt>VERSION</tt></i>-libs.tar.gz</tt>,
<tt class="filename">ArgoUML-<i class="replaceable"><tt>VERSION</tt></i>-libs.zip</tt>,
<tt class="filename">ArgoUML-<i class="replaceable"><tt>VERSION</tt></i>-modules.tar.gz</tt>,
<tt class="filename">ArgoUML-<i class="replaceable"><tt>VERSION</tt></i>-modules.zip</tt>,
<tt class="filename">ArgoUML-<i class="replaceable"><tt>VERSION</tt></i>-src.tar.gz</tt>,
<tt class="filename">ArgoUML-<i class="replaceable"><tt>VERSION</tt></i>-src.zip</tt>,
<tt class="filename">ArgoUML-<i class="replaceable"><tt>VERSION</tt></i>-app.tgz</tt>,
<tt class="filename">ArgoUML-<i class="replaceable"><tt>VERSION</tt></i>.tar.gz</tt>,
<tt class="filename">ArgoUML-<i class="replaceable"><tt>VERSION</tt></i>.zip</tt>, and
<tt class="filename">index.html</tt>.
There should also be a subdirectory
<tt class="filename">argouml/argouml-<i class="replaceable"><tt>VERSION</tt></i>/jws</tt>
with .jar and .jnlp files.
The .jar files in the subdirectory differ from
the jar files in the zip and tar archives
in that they are signed using your key.
</p></li><li><p>Test the release manually!</p><p>
The purpose of this is to make sure that there isn't any problem
introduced by the release procedure and that the jar files contains
the correct list of jars.
</p><p>
Either the 
<tt class="filename">ArgoUML-<i class="replaceable"><tt>VERSION</tt></i>.tar.gz</tt> or
<tt class="filename">ArgoUML-<i class="replaceable"><tt>VERSION</tt></i>.zip</tt>
file is tested.
Unpack,
start using the command <b class="command">java -jar argouml.jar</b>, and
do some ad-hoc testing.
</p><p>
If the tests did not pass See <a href="ch02s06.html#release_process_test_failed" title="2.6.1.&nbsp;The release did not work">Section&nbsp;2.6.1, &#8220;The release did not work&#8221;</a>.
</p></li><li><p>Run through the automatic tests!</p><p>
The purpose of this is to make sure that
at this point in the development of ArgoUML and the JUnit test cases,
all tests are working.
</p><p>
There are two sets of automatic test cases.
</p><div class="itemizedlist"><ul type="disc"><li><p>
Run the JUnit test cases in
<tt class="filename">argouml/tests</tt>
by issuing the command
<b class="command">build alltests</b>
in the <tt class="filename">argouml/src_new</tt> directory.
(Linus
It takes around 10 minutes on my machine 
        JDK1.3.1_10/Intel 1400MHz (on batteries)/512MB (February 2004),
It takes around 12 minutes on my machine 
	JDK1.3.1_01/Intel 700MHz/256MB (May 2003),
It takes around three (3) hours on a Lysator machine simultaneously
doing a lot of other things and the X session over a 50KB/s modem.
	JDK1.3.1_06/sun4d/256MB (July 2003).
)
</p><p>
There should not be any failed tests. 
(See details on where to find the result in
<a href="ch02s04.html" title="2.4.&nbsp;The JUnit test cases">Section&nbsp;2.4, &#8220;The JUnit test cases&#8221;</a>).
</p></li><li><p>
Run the JUnit test cases in 
<tt class="filename">modules/junit</tt>
by cd:ing to
<tt class="filename">modules/junit</tt>
and running <b class="command">build run</b>,
invoking JUnit tests from the Tools menu,
specifying the Test Case TestAll,
and running without "Reload classes every run" checked.
(See details in <a href="ch02s04.html" title="2.4.&nbsp;The JUnit test cases">Section&nbsp;2.4, &#8220;The JUnit test cases&#8221;</a>).
</p><p>
The corresponding <tt class="filename">build.sh</tt> is not available for
a Cygwin/Unix system so you must run the ant command directly.
First make the <b class="command">ant</b> executable with the command
<b class="command">chmod +x ../../tools/ant-1.4.1/bin/ant</b>
if you haven't made it above
and then issue the command 
<b class="command">../../tools/ant-1.4.1/bin/ant run</b> instead of the
<b class="command">build run</b> command.
</p><p>
No problems shall be found.
</p></li></ul></div><p>
</p><p>
If the tests did not pass See <a href="ch02s06.html#release_process_test_failed" title="2.6.1.&nbsp;The release did not work">Section&nbsp;2.6.1, &#8220;The release did not work&#8221;</a>.
</p></li><li><p>Tag the whole repository with the release tag!</p><p>
This tag is "VERSION_<i class="replaceable"><tt>X_Y_Z</tt></i>",
e.g. VERSION_0_9_7.
The according command line CVS command is 
<b class="command">cvs tag VERSION_<i class="replaceable"><tt>X_Y_Z</tt></i></b>
when your are standing in the
<tt class="filename">argouml</tt>-directory.
</p></li><li><p>
Open the repository for commits towards the next version.
</p><p>
This is done by setting the <tt class="methodname">argo.core.version</tt>
in <tt class="filename">default.properties</tt> to 
<i class="replaceable"><tt>Number of next release</tt></i>, committing
and telling everyone on the developers mailing list.
Notice that this cannot be done in the tagged copy but you either need
to go back to your other working tree or need to check out the file
<tt class="filename">argouml/src_new/default.properties</tt>
specifically to do this.
</p></li><li><p>Build documentation and copy it.</p><p>
While connected to the internet you download the docbook-xsl and
JimiProClasses.zip.
The docboox-xsl is downloaded by issueing the command
<b class="command">build docbook-xsl-get</b>.
The JimiProClasses.zip is downloaded from Sun.
Instructions for this is in the fop README file:
<tt class="filename">argouml/tools/fop-0.20.3/README</tt>.
</p><p>
The PDF versions of the documentation shall be copied from the
<tt class="filename">build/documentation/pdf/*/*.pdf</tt>
to
<tt class="filename">argouml-<i class="replaceable"><tt>version</tt></i>/<i class="replaceable"><tt>basename-version</tt></i></tt>.
</p></li><li><p>Upload the files onto the Tigris website!</p><p>
A tree with all files is located in 
<tt class="filename">argouml-<i class="replaceable"><tt>version</tt></i></tt>.
This complete tree is uploaded to argouml-upload on the site.
</p></li><li><p>
Go through Issuezilla and check things.
</p><p>
Things to check are:
</p><div class="orderedlist"><ol type="a"><li><p>
That there is a Version created in Issuezilla for the newly created release.
</p><p>
The purpose of this is to make it possible for everyone 
to report bugs on the new release.
</p></li><li><p>
Make sure that the upcoming releases have 
target milestones created for them.
This needs to be done for all components that has the same
release scheme.
Also see that the numbering is the same in all components and
that it is in the correct chronological order
except for the not yet done releases that come before the already completed.
</p></li><li><p>
Change the target milestones of all the not yet resolved issues 
for this release to ---.
</p></li><li><p>
Change the target milestones of
any fixed issue
in component argouml or modules
with target milestone ---
to that of the current release.
</p><p>
This is probably some developer that has fixed an issue by forgot to
set the target milestone correctly.
</p></li><li><p>
Move all issues reported on 'current' to this release
(for components argouml and modules).
</p><p>
These items were reported between the previous version and this version.
Since 'current' will be reused for the next release, they need to be
locked to the closest release to where they were found.
</p></li><li><p>Other stuff.</p><p>
This can also be a good time to change all 
RESOLVED/REMIND and RESOLVED/LATER.
Search for them and Reopen them.
</p></li></ol></div></li><li><p>Make announcements!</p><p>
Write a News announcements and a short note on 
the dev, users and announce lists.
Announcer should make sure that he/she is already subscribed to all lists
with a reference to the news item.
</p><p>
The announcement shall include
a statement on what kind of release this is,
information on what has changed (for stable releases this is a list of what
has changed since the last stable release),
the list of resolved issues,
a list of serious known problems with this release 
(stable releases shouldn't have any),
technical details on how the release was built, and
the plan for the following release.
</p><p>
Freshmeat: currently Thierry Lach does the Freshmeat announcements
which require a login so just inform him.
</p></li></ol></div><p>
</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="release_process_test_failed"></a>2.6.1.&nbsp;The release did not work</h3></div></div><div></div></div><a class="indexterm" name="d0e1926"></a><p>
This shouldn't happen! This really shouldn't happen!
</p><p>
The reason that this has happened is that one of the developers 
has made a mistake.
You now must decide a way forward.
</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="release_work_fix_problem_yourself"></a>2.6.1.1.&nbsp;Fix the problem yourself.</h4></div></div><div></div></div><p>
If the problem is obvious to you and you can fix it quickly, do so.
This is done by doing the following:
</p><div class="itemizedlist"><ul type="disc"><li><p>Make the release tag into a branch</p><p>
<b class="command">cvs rtag -b -r VERSION_<i class="replaceable"><tt>X_Y_Z</tt></i>_F BRANCH_<i class="replaceable"><tt>X_Y_Z</tt></i></b>
</p></li><li><p>Update your checked out copy to be on that branch</p><p>
<b class="command">cvs update -r BRANCH_<i class="replaceable"><tt>X_Y_Z</tt></i></b>
</p></li><li><p>Fix the problem in your checked out copy</p></li><li><p>Commit the problem in the branch</p><p>
<b class="command">cvs commit -m'Fix of problem blabla'</b>
</p></li><li><p>Continue the build process</p><p>
This is done by restarting the <b class="command">build dist-release</b>-command
and from that point on working in the branch instead of at the tag.
</p></li><li><p>
Explain to the culprit what mistakes he has made and how to fix it.
</p><p>
It is now his responsibility to make sure that the problem will not
appear in the next version.
He can do this either by merging in your fix or by fixing the problem
in some other way.
</p><p>
At this point an in-detail description of how poor programming skills
the culprit has and how ugly his mother is, is probably in place but
please keep it constructive!
Remember, you might be mistaken when you guess who the responsible is.
</p></li></ul></div><p>
</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1991"></a>2.6.1.2.&nbsp;
Delay the release waiting for someone to fix the problem.
</h4></div></div><div></div></div><p>
Create the branch as described in 
<a href="ch02s06.html#release_work_fix_problem_yourself" title="2.6.1.1.&nbsp;Fix the problem yourself.">Section&nbsp;2.6.1.1, &#8220;Fix the problem yourself.&#8221;</a>.
Then tell the culprit and everyone on the developer list
what the problem is and that it is to be fixed in the
release branch a.s.a.p.
</p><p>
Monitor the changes made to the branch to verify that
no one commits anything else but the solutions to the
problems.
</p><p>
When you get notified that it is completed, 
update your checked out copy and continue the release work.
</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch02s05.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch02.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch03.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">2.5.&nbsp;Manual Test Cases&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;3.&nbsp;ArgoUML requirements</td></tr></table></div></body></html>